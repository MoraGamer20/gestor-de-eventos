<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Asientos de Evento - Nuevo Evento</title>
    <style>
        :root {
            --color-primary: #4A90E2;
            --color-primary-hover: #3A80D2;
            --color-background: #F5F7FA;
            --color-text: #333333;
            --color-text-light: #6E7A8A;
            --color-border: #DADEE6;
            --color-white: #FFFFFF;
            --color-active: #66BB6A;
            --color-inactive: #9E9E9E;
            --color-finished: #EF5350;
            --color-error: #F44336;
            --shadow-soft: 0 2px 8px rgba(0, 0, 0, 0.08);
            --radius: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Roboto', sans-serif;
        }

        body {
            background-color: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 24px;
        }

        .modal-content {
            background-color: var(--color-white);
            border-radius: var(--radius);
            padding: 24px;
            width: 100%;
            max-width: 600px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            margin: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--color-border);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--color-text);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--color-text-light);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: var(--color-text);
        }

        .required-marker {
            color: var(--color-error);
            margin-left: 4px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--color-border);
            border-radius: var(--radius);
            font-size: 14px;
            color: var(--color-text);
            background-color: var(--color-white);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.1);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-row {
            display: flex;
            gap: 16px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .error-message {
            color: var(--color-error);
            font-size: 12px;
            margin-top: 6px;
            display: none;
        }

        .color-picker-container {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .color-option {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .color-option.selected {
            border-color: var(--color-text);
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 32px;
            padding-top: 16px;
            border-top: 1px solid var(--color-border);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border-radius: var(--radius);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: var(--color-primary);
            color: var(--color-white);
            border: none;
        }

        .btn-primary:hover {
            background-color: var(--color-primary-hover);
        }

        .btn-secondary {
            background-color: var(--color-white);
            color: var(--color-text);
            border: 1px solid var(--color-border);
        }

        .btn-secondary:hover {
            background-color: var(--color-background);
        }

        .field-info {
            font-size: 12px;
            color: var(--color-text-light);
            margin-top: 4px;
            font-style: italic;
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon input {
            padding-right: 40px;
        }

        .input-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--color-text-light);
        }
    </style>
</head>
<body>
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">Crear Nuevo Evento</h2>
            <button type="button" class="close-modal" id="close-event-modal">&times;</button>
        </div>
        
        <form id="event-form">
            <input type="hidden" id="event-id">
            <div class="form-group">
                <label for="event-name">Nombre del evento<span class="required-marker">*</span></label>
                <input type="text" id="event-name" name="event-name" placeholder="Ej: Conferencia Anual FCAV 2025" required>
                <p class="error-message" id="event-name-error">El nombre del evento es obligatorio</p>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="event-date">Fecha del evento<span class="required-marker">*</span></label>
                    <input type="date" id="event-date" name="event-date" required>
                    <p class="error-message" id="event-date-error">Selecciona una fecha v谩lida (no puede ser anterior a hoy)</p>
                </div>
                
                <div class="form-group">
                    <label for="event-time">Hora del evento</label>
                    <input type="time" id="event-time" name="event-time">
                    <p class="field-info">Recomendable para mejor organizaci贸n</p>
                </div>
            </div>
            
            <div class="form-group">
                <label for="event-location">Ubicaci贸n<span class="required-marker">*</span></label>
                <input type="text" id="event-location" name="event-location" placeholder="Ej: Auditorio 1" required>
                <p class="error-message" id="event-location-error">La ubicaci贸n es obligatoria</p>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="event-category">Categor铆a del evento<span class="required-marker">*</span></label>
                    <select id="event-category" name="event-category" required>
                        <option value="" disabled selected>Selecciona una categor铆a</option>
                        <option value="cultural">Cultural</option>
                        <option value="academic">Acad茅mico</option>
                        <option value="sports">Deportivo</option>
                        <option value="meeting">Reuni贸n</option>
                        <option value="other">Otro</option>
                    </select>
                    <p class="error-message" id="event-category-error">Selecciona una categor铆a</p>
                </div>
                
                <div class="form-group">
                    <label for="event-status">Estado del evento<span class="required-marker">*</span></label>
                    <select id="event-status" name="event-status" required>
                        <option value="active" selected>Activo</option>
                        <option value="inactive">Inactivo</option>
                        <option value="finished">Finalizado</option>
                    </select>
                    <p class="error-message" id="event-status-error">Selecciona un estado</p>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="event-capacity">Capacidad m谩xima</label>
                    <div class="input-with-icon">
                        <input type="number" id="event-capacity" name="event-capacity" min="1" placeholder="N煤mero de asistentes permitidos">
                        <span class="input-icon"></span>
                    </div>
                    <p class="field-info">Opcional, para control de asistentes</p>
                </div>
                
                <div class="form-group">
                    <label for="event-color">Color del evento</label>
                    <div class="color-picker-container">
                        <div class="color-option selected" style="background-color: #4A90E2;" data-color="#4A90E2"></div>
                        <div class="color-option" style="background-color: #66BB6A;" data-color="#66BB6A"></div>
                        <div class="color-option" style="background-color: #FFA726;" data-color="#FFA726"></div>
                        <div class="color-option" style="background-color: #EF5350;" data-color="#EF5350"></div>
                        <div class="color-option" style="background-color: #AB47BC;" data-color="#AB47BC"></div>
                        <div class="color-option" style="background-color: #26C6DA;" data-color="#26C6DA"></div>
                    </div>
                    <input type="hidden" id="event-color" name="event-color" value="#4A90E2">
                    <p class="field-info">Opcional, para identificaci贸n visual</p>
                </div>
            </div>
            
            <div class="form-group">
                <label for="event-description">Descripci贸n breve</label>
                <textarea id="event-description" name="event-description" placeholder="Detalles adicionales sobre el evento..."></textarea>
                <p class="field-info">Opcional, informaci贸n relevante para los asistentes</p>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="cancel-event-btn">Cancelar</button>
                <button type="submit" class="btn btn-primary" id="save-event-btn">Guardar Evento</button>
            </div>
        </form>
    </div>

    <script>
        // Script para la validaci贸n y funcionalidades b谩sicas del formulario
        // Este script solo implementa las validaciones de ejemplo
        
        // Referencia a elementos del DOM
        const eventForm = document.getElementById('event-form');
        const eventNameInput = document.getElementById('event-name');
        const eventDateInput = document.getElementById('event-date');
        const eventLocationInput = document.getElementById('event-location');
        const eventCategorySelect = document.getElementById('event-category');
        const eventStatusSelect = document.getElementById('event-status');
        const colorOptions = document.querySelectorAll('.color-option');
        const eventColorInput = document.getElementById('event-color');
        
        // Configurar fecha m铆nima en el campo de fecha (hoy)
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const dd = String(today.getDate()).padStart(2, '0');
        const todayFormatted = `${yyyy}-${mm}-${dd}`;
        eventDateInput.setAttribute('min', todayFormatted);
        
        // Manejo de la selecci贸n de color
        colorOptions.forEach(option => {
            option.addEventListener('click', function() {
                // Quitar selecci贸n previa
                colorOptions.forEach(opt => opt.classList.remove('selected'));
                // Marcar como seleccionado
                this.classList.add('selected');
                // Guardar el valor del color
                eventColorInput.value = this.getAttribute('data-color');
            });
        });
        
        // Validaci贸n del formulario
        eventForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            let isValid = true;
            
            // Validar nombre del evento
            if (!eventNameInput.value.trim()) {
                document.getElementById('event-name-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('event-name-error').style.display = 'none';
            }
            
            // Validar fecha del evento
            if (!eventDateInput.value) {
                document.getElementById('event-date-error').style.display = 'block';
                isValid = false;
            } else {
                // Validar que la fecha no sea anterior a hoy si el estado es "activo"
                if (eventStatusSelect.value === 'active') {
                    const selectedDate = new Date(eventDateInput.value);
                    const today = new Date();
                    today.setHours(0, 0, 0, 0); // Resetear hora para comparar solo fechas
                    
                    if (selectedDate < today) {
                        document.getElementById('event-date-error').style.display = 'block';
                        isValid = false;
                    } else {
                        document.getElementById('event-date-error').style.display = 'none';
                    }
                } else {
                    document.getElementById('event-date-error').style.display = 'none';
                }
            }
            
            // Validar ubicaci贸n
            if (!eventLocationInput.value.trim()) {
                document.getElementById('event-location-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('event-location-error').style.display = 'none';
            }
            
            // Validar categor铆a
            if (!eventCategorySelect.value) {
                document.getElementById('event-category-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('event-category-error').style.display = 'none';
            }
            
            // Si todo es v谩lido, enviar datos al padre
            if (isValid) {
                const eventData = {
                    name: eventNameInput.value,
                    date: eventDateInput.value,
                    time: document.getElementById('event-time').value,
                    location: eventLocationInput.value,
                    category: eventCategorySelect.value,
                    status: eventStatusSelect.value,
                    capacity: document.getElementById('event-capacity').value,
                    color: eventColorInput.value,
                    description: document.getElementById('event-description').value
                };
                
                window.parent.postMessage({
                    type: 'eventCreated',
                    eventData: eventData
                }, '*');
            }
        });
        
        // Botones de cancelar y cerrar
        document.getElementById('cancel-event-btn').addEventListener('click', function() {
            window.parent.postMessage('closeModal', '*');
        });
        
        document.getElementById('close-event-modal').addEventListener('click', function() {
            window.parent.postMessage('closeModal', '*');
        });
    </script>
</body>
</html>
